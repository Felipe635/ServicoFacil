<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:replace="fragments :: head"></head>
<body>

<div th:replace="fragments :: menu-cadastro" ></div>

<div>
    <div class="cima">
        <h2>Painel do Cliente</h2>
            <img src="/css/img/perfil.png" alt="" class="img-perfil">
        <br>
    </div>

    <div>
        <h4 class="texto-agenda">Agendamentos</h4>
        <div class="lista-agenda">
        <div class="card-agenda">
            <h6 class="card-title">Nome do Prestador</h6>
            <p class="card-texto">Detalhes do serviço</p>
            <h6 class="card-title">Data de Agendamento</h6>
            <h6 class="card-title">Valor</h6>
        </div>
        </div>
    </div>

</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    fetch('/order/getAllOrders')
        .then(response => response.json())
        .then(data => {
            const container = document.querySelector('.lista-agenda');
            data.forEach(order => {
                const card = document.createElement('div');
                card.className = 'card-agenda';
                card.innerHTML = `
                    <h6 class="card-title">${order.provider.username}</h6> <!-- Verifique se 'username' é o campo correto -->
                    <p class="card-texto">${order.description || 'Descrição não disponível'}</p> <!-- Trata 'null' em 'description' -->
                    <h6 class="card-title">${new Date(order.dtCadastro).toLocaleDateString()}</h6> <!-- Formata a data -->
                    <h6 class="card-title">R$ ${order.provider.serviceValue || 'Preço não disponível'}</h6> <!-- Assume que há um campo 'price', adicione se necessário -->
                `;
                container.appendChild(card);
            });
        })
        .catch(error => console.error('Error loading the orders:', error));
});

</script>
    



<footer th:replace="fragments :: footer" ></footer>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
</body>
</html>